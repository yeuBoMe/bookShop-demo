= bookShop-demo
Demo project minh họa lỗ hổng bảo mật JWT khi sử dụng secret key yếu (HS256)

== Danh sách thành viên nhóm
- *Lý Hoài Ninh* – MSSV: 22810310256
- *Bùi Hữu Nghĩa* – MSSV: 22810310246

== Phân chia công việc
- *Lý Hoài Ninh*: Code chính dự án, cấu hình bảo mật, khắc phục các lỗ hổng (cố tình để lại JWT weak secret để demo)
- *Bùi Hữu Nghĩa*: Code + thực hiện demo crack JWT bằng secret key yếu

== Mục đích
Minh họa toàn bộ quy trình tấn công thực tế:
Brute-force secret key của JWT (HS256) → Forge token mới với role = ADMIN

== Công cụ cần chuẩn bị
- hashcat (tải tại): https://hashcat.net/hashcat/

== Hướng dẫn thực hiện demo (từng bước)

=== B1: Đăng nhập để lấy token
image::demo/demo/image-2025-12-09-10-54-38-325.png[][Login]

=== B2: Lấy access token từ response của server
image::demo/demo/image-2025-12-09-10-55-24-391.png[][Access Token]

=== B3: Phân tích JWT → xác định thuật toán HS256
image::demo/demo/image-2025-12-09-10-55-46-709.png[][Phân tích JWT]

=== B4: Tạo wordlist các secret key yếu 32-byte trong thư mục hashcat
image::demo/demo/image-2025-12-09-10-56-04-913.png[][Tạo wordlist]

=== B5: Chạy hashcat để crack secret key
Mở terminal/cmd tại thư mục chứa hashcat.exe và chạy:

[source,bash]
----
.\hashcat.exe -m 16500 token.txt weak_32byte_plain.txt -w 3 --force
----

- `token.txt`: chứa nguyên chuỗi JWT cần crack
- `weak_32byte_plain.txt`: danh sách các secret key yếu

Kết quả → Cracked thành công trong vài giây

image::demo/demo/image-2025-12-09-10-57-32-066.png[][Hashcat cracked]

=== B6: Forge token mới với role = ADMIN bằng Python
Script `forge.py` đã có sẵn trong thư mục hashcat

image::demo/demo/image-2025-12-09-10-56-41-514.png[][Script forge.py]

Chạy lệnh:
[source,bash]
----
python forge.py
----

Kết quả: Token giả mạo có claim "role": "ADMIN"

image::demo/demo/image-2025-12-09-10-58-58-768.png[][Fake ADMIN token]

=== B7: So sánh trước và sau khi tấn công

*Trước khi crack (role = USER)*

image::demo/demo/image-2025-12-09-10-59-33-905.png[][Trước khi crack]

*Sau khi dùng token giả mạo (role = ADMIN)*

image::demo/demo/image-2025-12-09-10-59-54-329.png[][Sau khi crack]

== Kết luận & Bài học bảo mật
- Tuyệt đối không dùng secret key yếu hoặc có độ dài < 32 byte thực sự ngẫu nhiên với HS256
- Nên chuyển sang HS512 hoặc ít nhất dùng secret ≥ 256 bit entropy
- Luôn đặt thời gian hết hạn ngắn (exp) và bảo vệ cookie chứa JWT đúng cách

== Lưu ý
- Vì lý do bảo mật nên nhóm em xin từ chối cung cấp source code chính thức
- Quá trình demo sẽ đề cập đến source code trong dự án.

© 2025 – Nhóm Lý Hoài Ninh & Bùi Hữu Nghĩa